# Define the directory where the batch files are located
$batchFileDirectory = "C:\Scripts"

# Define the list of batch files to execute
$batchFiles = @(
    Join-Path $batchFileDirectory "batch1.bat",
    Join-Path $batchFileDirectory "batch2.bat",
    Join-Path $batchFileDirectory "batch3.bat",
    Join-Path $batchFileDirectory "batch4.bat",
    Join-Path $batchFileDirectory "batch5.bat"
)

# Define the Execute-BatchFile function
function Execute-BatchFile {
    param (
        [string]$batchFile
    )
    
    # Start the batch file process and return the process object
    return Start-Process -FilePath $batchFile -NoNewWindow -PassThru
}

# Create an array to hold process objects
$processes = @()

# Start all batch files simultaneously
foreach ($batchFile in $batchFiles) {
    $process = Execute-BatchFile -batchFile $batchFile
    $processes += $process
}

# Wait for all processes to complete
foreach ($process in $processes) {
    $process.WaitForExit()
    $exitCode = $process.ExitCode
    $batchFileName = $process.StartInfo.FileName
    if ($exitCode -ne 0) {
        Write-Output "$batchFileName failed with exit code $exitCode."
    } else {
        Write-Output "$batchFileName completed successfully."
    }
}
