# Define the target directory
$targetDirectory = "C:\Path\To\Your\Folder"

# Define the date threshold (files older than this date will be deleted)
$dateThreshold = (Get-Date).AddMonths(-3)

# Get the directory information using .NET
$directoryInfo = New-Object System.IO.DirectoryInfo $targetDirectory

# Get all files in the directory
$files = $directoryInfo.GetFiles()

# Filter and delete files older than the threshold date
foreach ($file in $files) {
    if ($file.CreationTime -lt $dateThreshold) {
        try {
            $file.Delete()
            Write-Output "Deleted file: $($file.FullName)"
        } catch {
            Write-Error "Failed to delete file: $($file.FullName). Error: $_"
        }
    }
}

# Optional: To include subdirectories
$subdirectories = $directoryInfo.GetDirectories("*", [System.IO.SearchOption]::AllDirectories)
foreach ($subdirectory in $subdirectories) {
    $files = $subdirectory.GetFiles()
    foreach ($file in $files) {
        if ($file.CreationTime -lt $dateThreshold) {
            try {
                $file.Delete()
                Write-Output "Deleted file: $($file.FullName)"
            } catch {
                Write-Error "Failed to delete file: $($file.FullName). Error: $_"
            }
        }
    }
}
